{% extends 'base.html' %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold text-center mb-8">Quiz Review</h1>
    <p class="text-center text-gray-600 mb-8">You scored {{ result.score }} out of {{ result.total_questions }} ({{ result.percentage }}%)</p>
    
    {% for question in questions %}
    <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
        <h3 class="text-xl font-semibold mb-4">{{ forloop.counter }}. {{ question.question_text }}</h3>
        
        <div class="space-y-2 mb-4">
            <div class="flex items-center p-3 rounded-lg {% if question.correct_option == 1 %}bg-green-100 border border-green-200{% elif user_answers.question.id.selected_option == 1 %}bg-red-100 border border-red-200{% else %}bg-gray-50{% endif %}">
                <span class="mr-3 font-semibold">A)</span>
                <span>{{ question.option1 }}</span>
                {% if question.correct_option == 1 %}<i class="fas fa-check text-green-600 ml-auto"></i>{% endif %}
            </div>
            <div class="flex items-center p-3 rounded-lg {% if question.correct_option == 2 %}bg-green-100 border border-green-200{% elif user_answers.question.id.selected_option == 2 %}bg-red-100 border border-red-200{% else %}bg-gray-50{% endif %}">
                <span class="mr-3 font-semibold">B)</span>
                <span>{{ question.option2 }}</span>
                {% if question.correct_option == 2 %}<i class="fas fa-check text-green-600 ml-auto"></i>{% endif %}
            </div>
            <div class="flex items-center p-3 rounded-lg {% if question.correct_option == 3 %}bg-green-100 border border-green-200{% elif user_answers.question.id.selected_option == 3 %}bg-red-100 border border-red-200{% else %}bg-gray-50{% endif %}">
                <span class="mr-3 font-semibold">C)</span>
                <span>{{ question.option3 }}</span>
                {% if question.correct_option == 3 %}<i class="fas fa-check text-green-600 ml-auto"></i>{% endif %}
            </div>
            <div class="flex items-center p-3 rounded-lg {% if question.correct_option == 4 %}bg-green-100 border border-green-200{% elif user_answers.question.id.selected_option == 4 %}bg-red-100 border border-red-200{% else %}bg-gray-50{% endif %}">
                <span class="mr-3 font-semibold">D)</span>
                <span>{{ question.option4 }}</span>
                {% if question.correct_option == 4 %}<i class="fas fa-check text-green-600 ml-auto"></i>{% endif %}
            </div>
        </div>
        
        {% if question.explanation %}
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4">
            <h4 class="font-semibold text-blue-800 mb-2">Explanation:</h4>
            <p class="text-blue-700">{{ question.explanation }}</p>
        </div>
        {% endif %}
        
        <div class="mt-4 text-sm text-gray-600">
            {% with answer=user_answers|get_item:question.id %}
            <p>Your answer: <span class="font-semibold {% if answer.is_correct %}text-green-600{% else %}text-red-600{% endif %}">
                Option {{ answer.selected_option }} {% if answer.is_correct %}(Correct){% else %}(Incorrect){% endif %}
            </span></p>
            {% endwith %}
        </div>
    </div>
    {% endfor %}
    
    <div class="text-center mt-8">
        <a href="{% url 'quiz' %}" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded transition duration-300">
            Take Another Quiz
        </a>
    </div>
</div>
{% endblock %}